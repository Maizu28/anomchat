:root {
	/* Warna WhatsApp Light (default) */
	--whatsapp-green: #075e54;
	--whatsapp-light-green: #128c7e;
	--whatsapp-bubble-received: #e0e0e0;
	--whatsapp-bubble-sent: #dcf8c6;
	--whatsapp-background: #ece5dd;
	--whatsapp-text-dark: #262626;
	--whatsapp-text-light: #4a4a4a;
	--whatsapp-blue-check: #34b7f1;

	/* Warna WhatsApp Dark Mode */
	--dark-bg-primary: #1f2c34; /* Background utama aplikasi */
	--dark-bg-secondary: #0b1416; /* Background chat */
	--dark-header-bg: #202c33;
	--dark-bubble-received: #202c33; /* Bubble pesan yang diterima */
	--dark-bubble-sent: #005c4b; /* Bubble pesan yang dikirim */
	--dark-text-primary: #e9edef; /* Warna teks utama */
	--dark-text-secondary: #8696a0; /* Warna teks sekunder (timestamp) */
	--dark-input-bg: #2a3942; /* Background input chat */
	--dark-icon-color: #8696a0;
}

/* === Global Reset dan Skala === */
html,
body {
	height: 100%;
	width: 100%;
	margin: 0;
	padding: 0;
	overflow: hidden; /* Mencegah scroll pada level ini */
}

html {
	font-size: 16px; /* Default desktop base font size */
}

body {
	font-family: "Segoe UI", Helvetica, Arial, sans-serif;
	background-color: var(--dark-bg-secondary); /* Dark mode background */
	display: flex;
	justify-content: center;
	align-items: flex-start;
	color: var(--dark-text-primary); /* Dark mode text color */
	font-size: 1rem;
}

.chat-container {
	background-color: var(--dark-bg-primary); /* Dark mode container bg */
	width: 100%;
	height: 100%; /* Mengisi 100% tinggi dari parent (body) */
	display: flex;
	flex-direction: column;
	overflow: hidden;
	box-shadow: none;
	border-radius: 0;
	margin: 0;
}

/* === Header Chat (Dark Mode) === */
.chat-header {
	display: flex;
	align-items: center;
	padding: 1rem 1rem; /* Padding lebih kecil, lebih padat */
	background-color: var(--dark-header-bg); /* Dark mode header bg */
	color: var(--dark-text-primary);
	box-shadow: 0 0.125rem 0.3125rem rgba(0, 0, 0, 0.2); /* Shadow lebih gelap */
	z-index: 10;
	flex-shrink: 0;
}

.chat-header img {
	width: 2.5rem; /* Ukuran ikon di header, 40px */
	height: 2.5rem;
	border-radius: 50%;
	margin-right: 0.75rem; /* 12px */
	object-fit: cover;
	background-color: var(
		--dark-text-primary
	); /* Border putih tipis di dark mode */
	padding: 0.125rem;
}

.group-info {
	flex-grow: 1;
}

.group-info h2 {
	margin: 0;
	font-size: 1.1rem; /* Ukuran judul grup */
	font-weight: 500;
	color: var(--dark-text-primary);
}

.group-info p {
	margin: 0;
	font-size: 0.8rem; /* Ukuran info status */
	opacity: 0.9;
	color: var(--dark-text-secondary);
}

/* === Chat Box (Area Pesan - Dark Mode) === */
.chat-box {
	flex-grow: 1;
	padding: 0.625rem 0.9375rem; /* 10px 15px */
	overflow-y: auto; /* Bisa di-scroll */
	background-color: var(--dark-bg-secondary); /* Dark mode chat background */
	display: flex;
	flex-direction: column;
	gap: 0.5rem; /* 8px */
	scroll-behavior: smooth;
	background-image: url("https://user-images.githubusercontent.com/15075759/28719144-8ff00730-746a-11e7-9192-3e215d263901.png"); /* Contoh dark pattern, ganti dengan URL Anda */
	background-repeat: repeat;
	background-size: 10rem; /* Sesuaikan ukuran pattern jika perlu */
}

/* Scrollbar styling for a cleaner look */
.chat-box::-webkit-scrollbar {
	width: 0.375rem;
}

.chat-box::-webkit-scrollbar-track {
	background: var(--dark-bg-primary);
}

.chat-box::-webkit-scrollbar-thumb {
	background: #555;
	border-radius: 0.1875rem;
}

.chat-box::-webkit-scrollbar-thumb:hover {
	background: #777;
}

/* === Pesan (Chat Bubbles - Dark Mode) === */
.message {
	padding: 0.5rem 0.625rem; /* 8px 10px */
	border-radius: 0.5rem; /* 8px */
	max-width: 75%; /* Sedikit lebih kecil agar mirip WhatsApp */
	position: relative;
	font-size: 0.9rem; /* 14.4px */
	line-height: 1.3;
	box-shadow: 0 0.0625rem 0.03125rem rgba(0, 0, 0, 0.13);
	word-wrap: break-word;
}

.message::before {
	content: "";
	position: absolute;
	top: 0;
	width: 0;
	height: 0;
	border-style: solid;
}

/* Pesan Diterima (kiri) */
.message:not(.user-local) {
	background-color: var(
		--dark-bubble-received
	); /* Warna bubble received dark mode */
	align-self: flex-start;
	border-top-left-radius: 0.1875rem;
	border-bottom-left-radius: 0.1875rem;
	border-top-right-radius: 0.5rem;
	border-bottom-right-radius: 0.5rem;
}

.message:not(.user-local)::before {
	border-width: 0 0.5rem 0.5rem 0; /* 0 8px 8px 0 */
	border-color: transparent var(--dark-bubble-received) transparent transparent;
	left: -0.4rem; /* -6.4px */
	top: 0.0625rem;
}

/* Pesan Dikirim (kanan) */
.message.user-local {
	background-color: var(--dark-bubble-sent); /* Warna bubble sent dark mode */
	align-self: flex-end;
	border-top-right-radius: 0.1875rem;
	border-bottom-right-radius: 0.1875rem;
	border-top-left-radius: 0.5rem;
	border-bottom-left-radius: 0.5rem;
}

.message.user-local::before {
	border-width: 0.5rem 0.5rem 0 0; /* 8px 8px 0 0 */
	border-color: var(--dark-bubble-sent) transparent transparent transparent;
	right: -0.4rem; /* -6.4px */
	top: 0.0625rem;
}

.message.optimistic {
	opacity: 0.7;
	border: 0.0625rem dashed #bbb;
	box-shadow: none;
}

.message.failed {
	background-color: #ffdddd;
	border: 0.0625rem solid #f00;
	color: #c00;
	opacity: 1;
	box-shadow: none;
}

.message-text-content {
	margin: 0;
	padding-bottom: 0.125rem;
	color: var(--dark-text-primary);
}

.message-text-content strong {
	color: var(--dark-text-primary); /* Username di dark bubble */
	font-weight: 600;
}

.timestamp {
	font-size: 0.6rem; /* 9.6px, lebih kecil */
	color: var(--dark-text-secondary); /* Warna timestamp dark mode */
	text-align: right;
	margin-top: 0.25rem;
	display: block;
}

/* === Form Input Chat (WhatsApp Style - Diperbaiki) === */
.chat-form {
	display: flex;
	/* align-items: flex-end; <-- Ganti ini untuk penyelarasan di tengah */
	align-items: center; /* Menyelaraskan item di tengah secara vertikal */
	background-color: var(--dark-header-bg); /* Background dark mode untuk form */
	border-top: 0.0625rem solid var(--dark-input-bg);
	padding-bottom: calc(
		env(safe-area-inset-bottom, 0.5rem) + 0.5rem
	); /* default 8px + 8px */
	flex-shrink: 0;
	gap: 0.5rem; /* Jarak antar elemen di form */

	width: 100%; /* Pastikan form mengisi 100% lebar container parent (.chat-container) */
	padding-left: 0.75rem; /* 12px padding kiri */
	padding-right: 0.75rem; /* 12px padding kanan */
	padding-top: 0.5rem; /* 8px padding atas */
}

.input-wrapper {
	flex-grow: 1;
	position: relative;
	display: flex;
	align-items: center;
	background-color: var(--dark-input-bg);
	border-radius: 1.5rem;
	box-shadow: 0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.1);
	/* Min-height wrapper harus sama dengan min-height textarea yang akan kita set */
	min-height: 2.75rem; /* 44px, ini menjadi tinggi standar input */
	transition: box-shadow 0.2s ease;
}

/* Fokus pada wrapper */
.input-wrapper:focus-within {
	box-shadow: 0 0 0 0.125rem rgba(0, 150, 136, 0.5); /* Hijau WhatsApp saat fokus */
}

textarea#message-input {
	flex-grow: 1;
	border: none;
	background-color: transparent;
	color: var(--dark-text-primary);
	font-size: 1rem;
	margin: 0;
	outline: none;
	resize: none;
	line-height: 1.4;
	overflow-y: hidden; /* Awalnya hidden, akan diubah JS jika teks banyak */
	white-space: pre-wrap;
	word-wrap: break-word;
	/* Padding untuk teks di dalam input, agar ada ruang kosong di kiri/kanan */
	padding: 0.75rem 1rem; /* 12px atas/bawah, 16px kiri/kanan */
	/* Pastikan min-height sama dengan input-wrapper */
	min-height: 2.75rem; /* 44px */
	max-height: 8rem; /* Batasi tinggi maksimum */
}

textarea#message-input::placeholder {
	color: var(--dark-icon-color);
	opacity: 0.8;
}

/* Tombol Kirim (Send Only) */
.send-button {
	background-color: var(--whatsapp-light-green);
	color: white;
	border: none;
	width: 3rem; /* 48px */
	height: 3rem; /* 48px */
	border-radius: 50%;
	display: flex;
	justify-content: center;
	align-items: center;
	font-size: 1.5rem; /* Ukuran ikon yang lebih besar */
	cursor: pointer;
	box-shadow: 0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.1);
	transition: background-color 0.3s ease, transform 0.1s ease;
	flex-shrink: 0;
}

.send-button:hover {
	background-color: #007a69;
}

.send-button:active {
	transform: scale(0.95);
}

.send-button:disabled {
	background-color: #b0b0b0;
	cursor: not-allowed;
	opacity: 0.8;
}

/* === Pesan Error === */
.error-message {
	text-align: center;
	color: #f2b3b3;
	padding: 0.625rem;
	background-color: #401f1f;
	border: 0.0625rem solid #603a3a;
	border-radius: 0.3125rem;
	margin-top: 0.625rem;
	font-size: 0.875rem;
}

/* === Media Queries untuk Skala Adaptif (Disesuaikan) === */
@media (max-width: 1024px) {
	html {
		font-size: 15px;
	}
}

@media (max-width: 768px) {
	html {
		font-size: 16px;
	}
	.chat-header {
		padding: 0.75rem 0.75rem;
	}
	.chat-header img {
		width: 2.2rem;
		height: 2.2rem;
		margin-right: 0.6rem;
	}
	.group-info h2 {
		font-size: 1rem;
	}
	.group-info p {
		font-size: 0.75rem;
	}
	.chat-box {
		padding: 0.5rem 0.75rem;
	}
	.message {
		font-size: 0.85rem;
	}
	.chat-form {
		padding: 0.4rem 0.4rem;
		gap: 0.4rem;
	}

	.input-wrapper {
		min-height: 2.5rem;
	}
	textarea#message-input {
		padding: 0.6rem 0.8rem;
		font-size: 0.9rem;
		min-height: 2.5rem;
		max-height: 7rem;
	}
	.send-button {
		width: 2.75rem;
		height: 2.75rem;
		font-size: 1.3rem;
	}
}

@media (max-width: 480px) {
	html {
		font-size: 17px;
	}
	.chat-header {
		padding: 0.6rem 0.6rem;
	}
	.chat-header img {
		width: 2rem;
		height: 2rem;
		margin-right: 0.5rem;
	}
	.group-info h2 {
		font-size: 0.95rem;
	}
	.group-info p {
		font-size: 0.7rem;
	}
	.chat-box {
		padding: 0.4rem 0.6rem;
	}
	.message {
		font-size: 0.8rem;
	}
	.chat-form {
		padding: 0.3rem 0.3rem;
		gap: 0.3rem;
	}

	.input-wrapper {
		min-height: 2.3rem;
	}
	textarea#message-input {
		padding: 0.5rem 0.7rem;
		font-size: 0.85rem;
		min-height: 2.3rem;
		max-height: 6rem;
	}
	.send-button {
		width: 2.5rem;
		height: 2.5rem;
		font-size: 1.2rem;
	}
}

/* Gaya tambahan untuk mode landscape pada mobile jika diperlukan */
@media screen and (orientation: landscape) and (max-height: 600px) {
	html {
		font-size: 13px;
	}
	.chat-header {
		padding: 0.5rem 0.5rem;
	}
	.chat-form {
		padding-top: 0.4rem;
		padding-bottom: calc(env(safe-area-inset-bottom, 0.4rem) + 0.25rem);
	}
	.input-wrapper {
		min-height: 2rem;
	}
	textarea#message-input {
		min-height: 2rem;
		max-height: 5rem;
	}
	.send-button {
		width: 2.2rem;
		height: 2.2rem;
		font-size: 1rem;
	}
}
